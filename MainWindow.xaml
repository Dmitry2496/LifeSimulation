<Window x:Class="LifeSimulation.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:LifeSimulation"
        mc:Ignorable="d"
        Title="Жизнь" Height="490" Width="940" MinHeight="490" MinWidth="940" x:Name="window" 
        Style="{DynamicResource WindowsStyle}" SizeChanged="Window_SizeChanged" MouseWheel="Window_MouseWheel">

    <Grid Loaded="MainWindowLoaded">
        <!-- #region Grid rows and columns -->
        <Grid.RowDefinitions>
            <RowDefinition Height="20"/>
            <RowDefinition Height="30"/>
            <RowDefinition Height="*" x:Name="rowGameSpace"/>
        </Grid.RowDefinitions>
        <!-- #endregion -->


        <!-- #endregion -->


        <!-- #region Top panel -->
        <Canvas Grid.Row="0"
                x:Name ="topCanvas">
            <Rectangle x:Name="topPanel"  
                       Style="{DynamicResource TopPanelStyle}" 
                       MouseLeftButtonDown="TopPanel_MouseLeftButtonDown"/>
            <Label Content="{DynamicResource Icon}" 
                   Height="20" 
                   Width="20"/>
            <TextBlock Text="{Binding Title, ElementName=window}" 
                       Canvas.Left="30" 
                       Foreground="{DynamicResource TextColor}"/>
            <Button x:Name="butMinimize" 
                    Style="{DynamicResource ButtonMinimizeStyle}" 
                    Click="ButtonMinimize_Click" />
            <Button x:Name="butMaximize" 
                    Style="{DynamicResource ButtonMaximizeStyle}" 
                    Click="ButtonMaximize_Click" />
            <Button x:Name="butClose" 
                    Style="{DynamicResource ButtonCloseStyle}" 
                    Click="ButtonClose_Click" />
        </Canvas>


        <!-- #region Control -->
        <StackPanel Orientation="Horizontal" Grid.Row="1" Background="{StaticResource TopPanelColor}">

            <Button Style="{DynamicResource button}"
                     Width="20"
                    Height="20"
                    VerticalAlignment="Center"
                    Margin="10,0,0,0" 
                    Click="ButtonStart_Click"  
                    ToolTip = "Старт">
                <Image Source="Resources/Start.png" Height="12" Width="12" Margin="-5,3,-5,0" />
            </Button>

            <Button Style="{DynamicResource button}"
                     Width="20"
                    Height="20"
                    VerticalAlignment="Center"
                    Margin="5,0,0,0" 
                    Click="ButtonNext_Click"  
                    ToolTip = "Шаг вперед">
                <Image Source="Resources/Arrow.ico" Height="14" Width="14" Margin="-5,2,-5,0" RenderTransformOrigin="0.5,0.5" >
                    <Image.RenderTransform>
                        <TransformGroup>
                            <ScaleTransform/>
                            <SkewTransform/>
                            <RotateTransform Angle="-90"/>
                            <TranslateTransform/>
                        </TransformGroup>
                    </Image.RenderTransform>
                </Image>
            </Button>

            <TextBlock x:Name="tbStep" Text="Шаг: 0" Margin="5,0,0,0" 
                       VerticalAlignment="Center"
                       Width="55"
                                   Foreground="{DynamicResource TextColor}"/>

            <Button Style="{DynamicResource button}"
                     Width="20"
                    Height="20"
                    VerticalAlignment="Center"
                    Margin="15,0,0,0" 
                    Click="ButtonClear_Click"  
                    ToolTip = "Очистить поле">
                <Image Source="Resources/delete.png" Height="16" Width="16" Margin="-4,1,-5,0" RenderTransformOrigin="0.5,0.5" />
            </Button>

            <Slider x:Name="gameSpeedSlider" 
                    HorizontalAlignment="Center" 
                    Margin="10,0,10,0" 
                    VerticalAlignment="Center" 
                    Width="120" 
                    ValueChanged="GameSpeedSlider_ValueChanged" 
                    Height="20"
                    BorderBrush="{DynamicResource BorderColor}"
                    BorderThickness="0" Style="{DynamicResource SliderStyle}"/>

            <Canvas Height="26"
                           Width="45">
                <Rectangle Height="26"
                           Width="45"
                           StrokeThickness="1"
                           Stroke="{StaticResource BorderColor}"
                           Margin="0,2,0,0"/>

                <StackPanel Orientation="Horizontal"  Height="26">

                    <Image Source="Resources/Point.png" Height="15" Width="15" Margin="3,0,0,0"/>


                    <StackPanel Orientation="Vertical">
                        <TextBlock x:Name="tbCurrentX" Text="X: 0" Margin="2,1,0,0" 
                                   Foreground="{DynamicResource TextColor}" FontSize="10"/>
                        <TextBlock x:Name="tbCurrentY" Text="Y: 0" Margin="2,-1,0,0" 
                                   Foreground="{DynamicResource TextColor}" FontSize="10"/>
                    </StackPanel>
                </StackPanel>
            </Canvas>

            <Canvas Height="26"
                           Width="290" Margin="10,0,0,0">
                <Rectangle Height="26"
                           Width="290"
                           StrokeThickness="1"
                           Stroke="{StaticResource BorderColor}"
                           Margin="0,2,0,0"/>

                <StackPanel Orientation="Horizontal"  Height="26">
                    <TextBlock Text="pix:" Margin="5,5,1,0" Foreground="{DynamicResource TextColor}" 
                               VerticalAlignment="Center"/>

                    <Canvas Height="18"
                           Width="35">
                        <Rectangle Height="18"
                           Width="34"
                           StrokeThickness="1"
                           Stroke="{StaticResource BorderColor}"
                           Margin="0,2,0,0"/>
                        <RepeatButton Height="18" x:Name="pixSizeDown"  Content="M 4 0 L 4 8 L 0 4 Z" Style="{StaticResource RepeatBtn}"
                                      VerticalAlignment="Center" Margin="2,3,0,0" Click="PixSizeDown_Click"/>
                        <TextBlock Text="99" x:Name="tbPixSize" Margin="10,3,0,0" Foreground="{DynamicResource TextColor}" 
                               VerticalAlignment="Center"/>
                        <RepeatButton Height="18" x:Name="pixSizeUp" Content="M 0 0 L 4 4 L 0 8 Z" Style="{StaticResource RepeatBtn}"
                                      VerticalAlignment="Center" Margin="25,3,0,0" Click="PixSizeUp_Click"/>
                    </Canvas>

                    <TextBlock Text="X:" Margin="5,5,1,0" Foreground="{DynamicResource TextColor}" VerticalAlignment="Center"/>
                    <TextBox Width="25" Height="18" Margin="0,3,0,0" Padding="-2,-0,0,0" x:Name="tbInputX" BorderBrush="{DynamicResource BorderColor}" 
                             BorderThickness="1" MaxLines="1" HorizontalAlignment="Left"
                             Foreground="{DynamicResource TextColor}" VerticalAlignment="Center" 
                             Background="{DynamicResource TextBoxBackColor}" Text="999"
                             TextChanged="InputCoordinate_TextChanged" MaxLength="3" LostFocus="InputCoordinate_LostFocus"/>

                    <TextBlock Text="Y:" Margin="5,5,1,0" Foreground="{DynamicResource TextColor}" VerticalAlignment="Center"/>
                    <TextBox Width="25" Height="18" Margin="0,3,0,0" Padding="-2,-0,0,0" x:Name="tbInputY" 
                             BorderBrush="{DynamicResource BorderColor}" BorderThickness="1" MaxLines="1" 
                             HorizontalAlignment="Left" VerticalAlignment="Center" Text="999"
                             Foreground="{DynamicResource TextColor}" Background="{DynamicResource TextBoxBackColor}"
                             TextChanged="InputCoordinate_TextChanged" MaxLength="3" LostFocus="InputCoordinate_LostFocus"/>


                    <StackPanel Orientation="Vertical">
                        <TextBlock x:Name="tbMinX" Text="Xmin: 10" Margin="5,1,0,0" 
                                   Foreground="{DynamicResource TextColor}" FontSize="10"/>
                        <TextBlock x:Name="tbMaxX" Text="Xmax: 10" Margin="5,-1,0,0" 
                                   Foreground="{DynamicResource TextColor}" FontSize="10"/>
                    </StackPanel>

                    <StackPanel Orientation="Vertical">
                        <TextBlock x:Name="tbMinY" Text="Ymin: 10" Margin="15,1,0,0" 
                                   Foreground="{DynamicResource TextColor}" FontSize="10"/>
                        <TextBlock x:Name="tbMaxY" Text="Ymax: 10" Margin="15,-1,0,0" 
                                   Foreground="{DynamicResource TextColor}" FontSize="10"/>
                    </StackPanel>
                </StackPanel>

            </Canvas>

            <Canvas Height="26"
                           Width="Auto" Margin="15,0,0,0">
                <StackPanel Orientation="Horizontal"  Height="26">
                    <ComboBox SelectedIndex="0" Height="20" Width="90" Padding="5,2,0,0" Name="cbRules"
                              VerticalAlignment="Center" Margin="0,3,0,0"
                              Style="{DynamicResource ComboBoxStyle}" SelectionChanged="CbRules_SelectionChanged"/>

                    <TextBlock Text="S:" Margin="10,5,1,0" Foreground="{DynamicResource TextColor}" 
                               VerticalAlignment="Center"/>
                    <TextBox Width="Auto" MaxWidth="65" MinWidth="10" Height="18" Margin="0,3,0,0" Padding="-2,-0,0,0" Name="tbS" 
                             BorderBrush="{DynamicResource BorderColor}" BorderThickness="1" MaxLines="1" 
                             HorizontalAlignment="Left" VerticalAlignment="Center" Text="0"
                             Foreground="{DynamicResource TextColor}" Background="{DynamicResource TextBoxBackColor}"
                             TextChanged="TbRules_TextChanged" MaxLength="9" LostFocus="TbRules_LostFocus"/>

                    <TextBlock Text="B:" Margin="5,5,1,0" Foreground="{DynamicResource TextColor}" 
                               VerticalAlignment="Center"/>
                    <TextBox Width="Auto" MaxWidth="65" MinWidth="10" Height="18" Margin="0,3,0,0" Padding="-2,-0,0,0" Name="tbB" 
                             BorderBrush="{DynamicResource BorderColor}" BorderThickness="1" MaxLines="1" 
                             HorizontalAlignment="Left" VerticalAlignment="Center" Text="0"
                             Foreground="{DynamicResource TextColor}" Background="{DynamicResource TextBoxBackColor}"
                             TextChanged="TbRules_TextChanged" MaxLength="9" LostFocus="TbRules_LostFocus"/>
                </StackPanel>
            </Canvas>
        </StackPanel>
        <!-- #endregion -->

        <Canvas Grid.Row="2" 
                x:Name="gameSpace" 
                HorizontalAlignment="Center"
                VerticalAlignment="Center" 
                Height="400"
                Width="400" 
                Loaded="GameSpace_Loaded" 
                Margin="20,20,20,20" Background="Gray"/>
    </Grid>
</Window>
